{
  "hash": "69f63862b1ae4eadfa259c998a0ae159",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Cross Lagged Panel Models\"\nformat:\n  live-html:\n    css: \n      - exams/webex.css\n    include-after-body: exams/webex.js\ntoc: true    \nlightbox: true\n---\n\n\n::: {.cell}\n\n:::\n\n\n\n## Grundidee\nDie Grundidee von Cross Lagged Panel Models ist die Modellierung von wechselseitigen Einflüssen zwischen zwei oder mehr Variablen über die Zeit hinweg. Dabei wird angenommen, dass jede Variable nicht nur durch ihre eigenen vorherigen Werte (autoregressive Effekte) beeinflusst wird, sondern auch durch die vorherigen Werte der anderen Variablen [cross-lagged Effekte, @mackinnon2022, @hamaker2015]. Dies ermöglicht es unter bestimmten Annahmen, kausale Beziehungen zwischen den Variablen zu untersuchen und zu verstehen, wie Veränderungen in einer Variable Veränderungen in einer anderen Variable im Laufe der Zeit beeinflussen können.\nInwiefern die Annahmen für die kausale Interpretierbarkeit von Cross-Lagged Panel Models realistisch sind, gilt als stark diskutiert [eine unterhaltsame Einführung bietet @rohrer2025b].\n\n\n## Datenimport\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(haven)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(stringr)\nlibrary(ggplot2)\nlibrary(colorspace)\nlibrary(tinytable)\nlibrary(lavaan)\n\ndata_star <- read_sav(\n  \"https://raw.githubusercontent.com/sammerk/WinterSchoolZH/master/data_star_workshop.sav\"\n)\n\n#data_star_subset <- read_sav(\"data_star_workshop.sav\") %>% \ndata_star_subset <- data_star %>%\n  group_by(classID) %>%\n  summarize(\n    MathClassMeanCl0 = mean(gktmathss, na.rm = T),\n    MathClassMeanCl1 = mean(g1tmathss, na.rm = T),\n    MathClassMeanCl2 = mean(g2tmathss, na.rm = T),\n    MathClassMeanCl3 = mean(g3tmathss, na.rm = T),\n    MathClassMeanCl4 = mean(g4tmathss, na.rm = T),\n    ReadClassMeanCl0 = mean(gktreadss, na.rm = T),\n    ReadClassMeanCl1 = mean(g1treadss, na.rm = T),\n    ReadClassMeanCl2 = mean(g2treadss, na.rm = T),\n    ReadClassMeanCl3 = mean(g3treadss, na.rm = T),\n    MathClassMeanCl4 = mean(g4treadss, na.rm = T),\n    SelfConRawCl1 = mean(g1selfconcraw, na.rm = T),\n    SelfConRawCl2 = mean(g2selfconcraw, na.rm = T),\n    SelfConRawCl3 = mean(g3selfconcraw, na.rm = T)\n  )\n```\n:::\n\n\n## Cross Lagged Panel Model\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_clp <- '\n\n# autoregressive paths\nReadClassMeanCl1 ~ ReadClassMeanCl0\nReadClassMeanCl2 ~ ReadClassMeanCl1\nReadClassMeanCl3 ~ ReadClassMeanCl2\n\nMathClassMeanCl1 ~ MathClassMeanCl0\nMathClassMeanCl2 ~ MathClassMeanCl1\nMathClassMeanCl3 ~ MathClassMeanCl2\n\n# cross lagged paths\nReadClassMeanCl1 ~ MathClassMeanCl0\nReadClassMeanCl2 ~ MathClassMeanCl1\nReadClassMeanCl3 ~ MathClassMeanCl2\n\nMathClassMeanCl1 ~ ReadClassMeanCl0\nMathClassMeanCl2 ~ ReadClassMeanCl1\nMathClassMeanCl3 ~ ReadClassMeanCl2\n'\n\n\nfit_clp <- sem(model_clp, data = data_star_subset)\nsummary(fit_clp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nlavaan 0.6-21 ended normally after 28 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        19\n\n                                                  Used       Total\n  Number of observations                           305        1280\n\nModel Test User Model:\n                                                      \n  Test statistic                               538.343\n  Degrees of freedom                                14\n  P-value (Chi-square)                           0.000\n\nParameter Estimates:\n\n  Standard errors                             Standard\n  Information                                 Expected\n  Information saturated (h1) model          Structured\n\nRegressions:\n                     Estimate  Std.Err  z-value  P(>|z|)\n  ReadClassMeanCl1 ~                                    \n    ReadClassMnCl0      0.737    0.146    5.057    0.000\n  ReadClassMeanCl2 ~                                    \n    ReadClassMnCl1      0.516    0.031   16.887    0.000\n  ReadClassMeanCl3 ~                                    \n    ReadClassMnCl2      0.529    0.035   15.007    0.000\n  MathClassMeanCl1 ~                                    \n    MathClassMnCl0      0.279    0.076    3.655    0.000\n  MathClassMeanCl2 ~                                    \n    MathClassMnCl1      0.424    0.042   10.111    0.000\n  MathClassMeanCl3 ~                                    \n    MathClassMnCl2      0.285    0.043    6.612    0.000\n  ReadClassMeanCl1 ~                                    \n    MathClassMnCl0      0.102    0.095    1.077    0.281\n  ReadClassMeanCl2 ~                                    \n    MathClassMnCl1      0.086    0.038    2.229    0.026\n  ReadClassMeanCl3 ~                                    \n    MathClassMnCl2      0.064    0.036    1.768    0.077\n  MathClassMeanCl1 ~                                    \n    ReadClassMnCl0      0.280    0.117    2.397    0.017\n  MathClassMeanCl2 ~                                    \n    ReadClassMnCl1      0.236    0.033    7.069    0.000\n  MathClassMeanCl3 ~                                    \n    ReadClassMnCl2      0.347    0.042    8.241    0.000\n\nCovariances:\n                      Estimate  Std.Err  z-value  P(>|z|)\n .ReadClassMeanCl3 ~~                                    \n   .MathClassMnCl3     150.400   15.068    9.981    0.000\n\nVariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .ReadClassMnCl1  728.132   58.962   12.349    0.000\n   .ReadClassMnCl2  262.532   21.259   12.349    0.000\n   .ReadClassMnCl3  181.107   14.666   12.349    0.000\n   .MathClassMnCl1  468.053   37.902   12.349    0.000\n   .MathClassMnCl2  313.438   25.381   12.349    0.000\n   .MathClassMnCl3  257.469   20.849   12.349    0.000\n```\n\n\n:::\n\n```{.r .cell-code}\nparameterEstimates(fit_clp, standardized = T) %>%\n  filter(op == \"~\") %>%\n  select(lhs, rhs, est, pvalue, std.all) %>%\n  tt(digits = 3)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script src=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.js\"></script>\n\n    <script>\n      // Create table-specific functions using external factory\n      const tableFns_8it4i5w27lruxuto5sos = TinyTable.createTableFunctions(\"tinytable_8it4i5w27lruxuto5sos\");\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: '12', j: 1 }, { i: '12', j: 2 }, { i: '12', j: 3 }, { i: '12', j: 4 }, { i: '12', j: 5 } ], css_id: 'tinytable_css_e8sr45gt249abu4vrwg3',}, \n          { positions: [ { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 }, { i: '0', j: 5 } ], css_id: 'tinytable_css_vamvitn4snqvo0yv20cs',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  tableFns_8it4i5w27lruxuto5sos.styleCell(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.css\">\n    <style>\n    /* tinytable css entries after */\n    #tinytable_8it4i5w27lruxuto5sos td.tinytable_css_e8sr45gt249abu4vrwg3, #tinytable_8it4i5w27lruxuto5sos th.tinytable_css_e8sr45gt249abu4vrwg3 {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    #tinytable_8it4i5w27lruxuto5sos td.tinytable_css_vamvitn4snqvo0yv20cs, #tinytable_8it4i5w27lruxuto5sos th.tinytable_css_vamvitn4snqvo0yv20cs {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    </style>\n    <div class=\"container\">\n      <table class=\"tinytable\" id=\"tinytable_8it4i5w27lruxuto5sos\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        \n        <thead>\n              <tr>\n                <th scope=\"col\" data-row=\"0\" data-col=\"1\">lhs</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"2\">rhs</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"3\">est</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"4\">pvalue</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"5\">std.all</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td data-row=\"1\" data-col=\"1\">ReadClassMeanCl1</td>\n                  <td data-row=\"1\" data-col=\"2\">ReadClassMeanCl0</td>\n                  <td data-row=\"1\" data-col=\"3\">0.7368</td>\n                  <td data-row=\"1\" data-col=\"4\">0.000000424983837455</td>\n                  <td data-row=\"1\" data-col=\"5\">0.4298</td>\n                </tr>\n                <tr>\n                  <td data-row=\"2\" data-col=\"1\">ReadClassMeanCl2</td>\n                  <td data-row=\"2\" data-col=\"2\">ReadClassMeanCl1</td>\n                  <td data-row=\"2\" data-col=\"3\">0.5157</td>\n                  <td data-row=\"2\" data-col=\"4\">0</td>\n                  <td data-row=\"2\" data-col=\"5\">0.692</td>\n                </tr>\n                <tr>\n                  <td data-row=\"3\" data-col=\"1\">ReadClassMeanCl3</td>\n                  <td data-row=\"3\" data-col=\"2\">ReadClassMeanCl2</td>\n                  <td data-row=\"3\" data-col=\"3\">0.5295</td>\n                  <td data-row=\"3\" data-col=\"4\">0</td>\n                  <td data-row=\"3\" data-col=\"5\">0.6618</td>\n                </tr>\n                <tr>\n                  <td data-row=\"4\" data-col=\"1\">MathClassMeanCl1</td>\n                  <td data-row=\"4\" data-col=\"2\">MathClassMeanCl0</td>\n                  <td data-row=\"4\" data-col=\"3\">0.2786</td>\n                  <td data-row=\"4\" data-col=\"4\">0.000257170969778953</td>\n                  <td data-row=\"4\" data-col=\"5\">0.3132</td>\n                </tr>\n                <tr>\n                  <td data-row=\"5\" data-col=\"1\">MathClassMeanCl2</td>\n                  <td data-row=\"5\" data-col=\"2\">MathClassMeanCl1</td>\n                  <td data-row=\"5\" data-col=\"3\">0.4243</td>\n                  <td data-row=\"5\" data-col=\"4\">0</td>\n                  <td data-row=\"5\" data-col=\"5\">0.4645</td>\n                </tr>\n                <tr>\n                  <td data-row=\"6\" data-col=\"1\">MathClassMeanCl3</td>\n                  <td data-row=\"6\" data-col=\"2\">MathClassMeanCl2</td>\n                  <td data-row=\"6\" data-col=\"3\">0.2854</td>\n                  <td data-row=\"6\" data-col=\"4\">0.00000000003793077</td>\n                  <td data-row=\"6\" data-col=\"5\">0.3237</td>\n                </tr>\n                <tr>\n                  <td data-row=\"7\" data-col=\"1\">ReadClassMeanCl1</td>\n                  <td data-row=\"7\" data-col=\"2\">MathClassMeanCl0</td>\n                  <td data-row=\"7\" data-col=\"3\">0.1024</td>\n                  <td data-row=\"7\" data-col=\"4\">0.281420256975449146</td>\n                  <td data-row=\"7\" data-col=\"5\">0.0915</td>\n                </tr>\n                <tr>\n                  <td data-row=\"8\" data-col=\"1\">ReadClassMeanCl2</td>\n                  <td data-row=\"8\" data-col=\"2\">MathClassMeanCl1</td>\n                  <td data-row=\"8\" data-col=\"3\">0.0856</td>\n                  <td data-row=\"8\" data-col=\"4\">0.025790079119930809</td>\n                  <td data-row=\"8\" data-col=\"5\">0.0914</td>\n                </tr>\n                <tr>\n                  <td data-row=\"9\" data-col=\"1\">ReadClassMeanCl3</td>\n                  <td data-row=\"9\" data-col=\"2\">MathClassMeanCl2</td>\n                  <td data-row=\"9\" data-col=\"3\">0.064</td>\n                  <td data-row=\"9\" data-col=\"4\">0.07708381901922956</td>\n                  <td data-row=\"9\" data-col=\"5\">0.078</td>\n                </tr>\n                <tr>\n                  <td data-row=\"10\" data-col=\"1\">MathClassMeanCl1</td>\n                  <td data-row=\"10\" data-col=\"2\">ReadClassMeanCl0</td>\n                  <td data-row=\"10\" data-col=\"3\">0.28</td>\n                  <td data-row=\"10\" data-col=\"4\">0.01654362216005989</td>\n                  <td data-row=\"10\" data-col=\"5\">0.2053</td>\n                </tr>\n                <tr>\n                  <td data-row=\"11\" data-col=\"1\">MathClassMeanCl2</td>\n                  <td data-row=\"11\" data-col=\"2\">ReadClassMeanCl1</td>\n                  <td data-row=\"11\" data-col=\"3\">0.2359</td>\n                  <td data-row=\"11\" data-col=\"4\">0.00000000000156164</td>\n                  <td data-row=\"11\" data-col=\"5\">0.3247</td>\n                </tr>\n                <tr>\n                  <td data-row=\"12\" data-col=\"1\">MathClassMeanCl3</td>\n                  <td data-row=\"12\" data-col=\"2\">ReadClassMeanCl2</td>\n                  <td data-row=\"12\" data-col=\"3\">0.3467</td>\n                  <td data-row=\"12\" data-col=\"4\">0.000000000000000222</td>\n                  <td data-row=\"12\" data-col=\"5\">0.4035</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}